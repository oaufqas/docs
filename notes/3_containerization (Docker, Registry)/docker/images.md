**Образ (Image)**: «Чертеж» или слепок приложения. Содержит всё необходимое для запуска, но сам по себе не работает.
Он доступен только для чтения и содержит всё: от операционной системы до кода и конфигов.


## Команды для управления образами:

docker **pull** nginx - Скачивает готовый образ из реестра (например, Docker Hub).
docker **images** - Показывает список всех образов на вашем компьютере.
docker **build** -t my-app:1.0 . - Собирает ваш собственный образ на основе Dockerfile.
docker **tag** my-app:1.0 user/my-app:latest - Присваивает образу новое имя или версию (тег)
docker **push** user/my-app:latest - Отправляет ваш образ в реестр (в облако)
docker **rmi** nginx - Удаляет локальный образ (image remove)
docker **inspect** python:3.9 - Показывает «подкапотные» детали образа (слои, переменные)
**dive** [image_name] - утилита для детального просмотра образов
docker image **prune** -a - Удаляет все неиспользуемые (висящие) образы

docker **build -f Dockerfile.prod** -t my-app:prod . - Собрать с другим Dockerfile
docker **build --no-cache** -t my-app:latest . - Собрать без кэша
docker **cp my-container:/app/logs/app.log ./app.log** Скопировать файл из контейнера на хост
docker **cp config.json my-container:/app/config.json** Скопировать файл с хоста в контейнер
docker **save -o my-app.tar my-app:latest** Сохранить образ в файл
docker **load -i my-app.tar** Загрузить образ из файла



Важный нюанс: Образ состоит из слоев. Если вы измените только одну строчку в коде, Docker при сборке не будет пересобирать весь образ целиком, а обновит только нужный слой. Это делает Docker очень быстрым. **Вся файловая структура докера представляет собой большое колличество переиспользуемых слоев**
Текущий используемый в docker драйвер - **overlay2**
Все слои кроме тонкого верхнего R/W (контейнера), монтируются как read-only


# Типы слоев:

- Base Layers: общие для многих образов, например ubuntu:22.04, alpine:3.18...
- Intermediate Layers: созданные командами RUN в Dockerfile, например RUN apt update, RUN pip install
- Application Layer: файлы приложений COPY . /app
- Container Layer: тонкий R/W слой, находящийся поверх всех слоев образа, хранит изменения во время работы контейнера, удаляется вместе с контейнером.

# Визуальная структура папок в системе: 

Если вы заглянете в /var/lib/docker/overlay2/, вы увидите длинные хеш-имена папок. Внутри каждой обычно находятся:
diff/ — фактическое содержимое этого слоя.
link — короткий идентификатор слоя.
lower — файл со списком идентификаторов всех нижележащих слоев.
merged/ — (только для запущенных контейнеров) результат слияния.

1. Экономия места: Если 10 образов используют один и тот же слой ubuntu:22.04, он хранится на диске в одном экземпляре.
2. Скорость: Запуск контейнера происходит мгновенно, так как Docker нужно просто создать пустую папку UpperDir и «наложить» её на готовый образ.
